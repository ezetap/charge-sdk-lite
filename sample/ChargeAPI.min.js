!function(e){"use strict";function a(){var e={},a="",r="",t="",s="",n="http://services-demo.ezetap.com/charge_api/v1",i="https://services.ezetap.com/charge_api/v1",o=!1;e.initialize=function(e,n){if(e&&e.appKey&&e.accountId&&e.userName&&e.appMode)if("PROD"==e.appMode.toUpperCase()||"DEMO"==e.appMode.toUpperCase()){a=e.appKey,t=e.accountId,r=e.userName,s=e.appMode,o=!0;var i={status:"success",error:null,result:{message:"SDK initialization successful"}}}else{var i={status:"failure",error:{code:"EZECLI_323023",message:"SDK initialization failed, App mode is not valid"}};o=!1}else{var i={status:"failure",error:{code:"EZECLI_323023",message:"SDK initialization failed, Mandatory parameters are missing"}};o=!1}n&&n(i)},e.close=function(e){a="",r="",t="",s="",o=!1;var n={status:"success",error:null,result:{message:"SDK close success"}};e&&e(n)},e.viewCharge=function(e,a){if(o)if(e&&e.chargeId){var r="/charges/"+e.chargeId;try{l(r,function(e){a&&a(e)})}catch(t){console.log(t)}}else{var s={status:"failure",error:{code:"EZECLI_323023",message:"Unable to view charge, Mandatory parameters are missing"}};a&&a(s)}else{var s={status:"failure",error:{code:"323024",message:"SDK is not initialized"}};a&&a(s)}},e.createCharge=function(e,a){if(o)if(e&&e.charge){var r="/charges/",s=e.charge;try{s.accountId=t,c(s,r,function(e){if(e&&"SUCCESS"==e.status.toUpperCase()){var e={status:"success",error:null,result:{chargeId:e.result.id}};a&&a(e)}else a&&a(e)})}catch(n){console.log(n)}}else{var i={status:"failure",error:{code:"EZECLI_323023",message:"Unable to create charge, Mandatory parameters are missing"}};a&&a(i)}else{var i={status:"failure",error:{code:"323024",message:"SDK is not initialized"}};a&&a(i)}},e.cancelCharge=function(e,a){if(o)if(e&&e.chargeId){var r="/charges/cancel/"+e.chargeId;try{u(r,function(r){if(r&&"SUCCESS"==r.status.toUpperCase()){var t={status:"success",error:null,result:{chargeId:e.chargeId}};a&&a(t)}else a&&a(r)})}catch(t){console.log(t)}}else{var s={status:"failure",error:{code:"EZECLI_323023",message:"Unable to cancel charge, Mandatory parameters are missing"}};a&&a(s)}else{var s={status:"failure",error:{code:"323024",message:"SDK is not initialized"}};a&&a(s)}},e.walletTransaction=function(a,t){if(o)if(a&&a.wallet&&a.wallet.walletProvider&&(a.charge||a.chargeId))try{var s="/remotePay/walletTransaction",n=function(n){var i={chargeId:n,walletProvider:a.wallet.walletProvider,username:r};c(i,s,function(r){var s=r;if(s&&"SUCCESS"==s.status.toUpperCase()){var i={status:"SUCCESS",result:{currentTxnId:s.result.txnId,chargeId:n}};t&&t(i)}else!a.chargeId||a.chargeId&&a.chargeId!=n?e.cancelCharge({chargeId:n},function(e){var a={status:"failure",error:{code:"EZECLI_323033",message:"Error occurred in wallet transaction"}};e&&"SUCCESS"==e.status.toUpperCase()?t&&t(a):t&&t(a)}):t&&t(s)})};if(a.chargeId)n(a.chargeId);else if(!a.chargeId&&a.charge){var i={charge:a.charge};e.createCharge(i,function(e){if(e&&"SUCCESS"==e.status.toUpperCase()){var a=e.result.chargeId;n(a)}else t&&t(e)})}}catch(l){console.log(l)}else{var u={status:"failure",error:{code:"EZECLI_323023",message:"Unable to initiate wallet transaction, Mandatory parameters are missing"}};t&&t(u)}else{var u={status:"failure",error:{code:"323024",message:"SDK is not initialized"}};t&&t(u)}},e.confirmPin=function(e,a){if(o)if(e&&e.txnId&&e.walletOTP)try{var r="/remotePay/confirmWalletTransaction",t={txnId:e.txnId,walletOTP:e.walletOTP};c(t,r,function(e){if(e&&"SUCCESS"==e.status.toUpperCase()){var r=e.result.currentTransaction,t={status:"SUCCESS",result:{currentTxn:{txnId:r.txnId,txnDate:r.transactionDate,txnType:r.txnType,paymentMode:r.paymentMode,amount:r.amount,receiptURL:r.receiptUrl,wallet:{walletProvider:r.wallet.walletProvider,walletCustomerAuthId:r.wallet.walletCustomerAuthId,walletChannelId:r.wallet.walletChannelId,walletMid:r.wallet.walletMid,walletAcquirer:r.wallet.walletAcquirer,walletRefTxnId:r.wallet.walletRefTxnId}},charge:e.result.charge}};a&&a(t)}else a&&a(e)})}catch(s){console.log(s)}else{var n={status:"failure",error:{code:"EZECLI_323023",message:"Unable to confirm wallet transaction, Mandatory parameters are missing"}};a&&a(n)}else{var n={status:"failure",error:{code:"323024",message:"SDK is not initialized"}};a&&a(n)}},e.remoteTransaction=function(a,t){if(o)if(a&&(a.charge||a.chargeId))try{var s="/remotePay/initiate",n=function(n){var i={chargeId:n,username:r};c(i,s,function(r){var s=r;if(s&&"SUCCESS"==s.status.toUpperCase()){var i={status:"SUCCESS",result:{chargeId:n}};t&&t(i)}else!a.chargeId||a.chargeId&&a.chargeId!=n?e.cancelCharge({chargeId:n},function(e){var a={status:"failure",error:{code:"EZECLI_323033",message:"Error occurred in remotePay"}};"SUCCESS"==e.status.toUpperCase()?t&&t(a):t&&t(a)}):t&&t(s)})};if(a.chargeId)n(a.chargeId);else if(!a.chargeId&&a.charge){var i={charge:a.charge};e.createCharge(i,function(e){if("SUCCESS"==e.status.toUpperCase()){var a=e.result.chargeId;n(a)}else t(e)})}}catch(l){console.log(l)}else{var u={status:"failure",error:{code:"EZECLI_323023",message:"Unable to initiate remotePay, Mandatory parameters are missing"}};t&&t(u)}else{var u={status:"failure",error:{code:"323024",message:"SDK is not initialized"}};t&&t(u)}},e.searchCharges=function(e,a){if(o)if(e){var r={accountId:t};e&&e.date&&(r.startDate=e.date+" 00:00:00",r.endDate=e.date+" 23:59:59"),e&&e.status&&(r.status=e.status);var s=$.param(r),n="/charges/search?"+s;try{l(n,function(e){a&&a(e)})}catch(i){console.log(i)}}else{var c={status:"failure",error:{code:"EZECLI_323023",message:"Unable to search charge, Mandatory parameters are missing"}};a&&a(c)}else{var c={status:"failure",error:{code:"323024",message:"SDK is not initialized"}};a&&a(c)}},e.viewTransaction=function(e,r){if(o)if(e&&e.txnId){var t="/merchant/txn/details",s={txnId:e.txnId,appKey:a};try{c(s,t,function(e){r&&r(e)})}catch(n){console.log(n)}}else{var i={status:"failure",error:{code:"EZECLI_323023",message:"Unable to view transaction, Mandatory parameters are missing"}};r&&r(i)}else{var i={status:"failure",error:{code:"323024",message:"SDK is not initialized"}};r&&r(i)}};var c=function(e,r,t){if("DEMO"==s.toUpperCase())var o=n+r;else if("PROD"==s.toUpperCase())var o=i+r;$.ajax({type:"POST",url:o,data:JSON.stringify(e),headers:{key:a,"Content-Type":"application/json"},success:function(e){"function"==typeof t&&t(e)},error:function(e){"function"==typeof t&&t(e)},dataType:"json"})},l=function(e,r){if("DEMO"==s.toUpperCase())var t=n+e;else if("PROD"==s.toUpperCase())var t=i+e;$.ajax({type:"GET",url:t,headers:{key:a,"Content-Type":"application/json"},success:function(e){"function"==typeof r&&r(e)},error:function(e){"function"==typeof r&&r(e)},dataType:"json"})},u=function(e,r){if("DEMO"==s.toUpperCase())var t=n+e;else if("PROD"==s.toUpperCase())var t=i+e;$.ajax({type:"DELETE",url:t,headers:{key:a,"Content-Type":"application/json"},success:function(e){"function"==typeof r&&e&&r(e)},error:function(e){"function"==typeof r&&e&&r(e)},dataType:"json"})};return e}"undefined"==typeof ChargeAPI?e.ChargeAPI=a():console.log("ChargeAPI Already defined")}(window);